var B=(d,D,m)=>new Promise((e,y)=>{var A=o=>{try{F(m.next(o))}catch(g){y(g)}},_=o=>{try{F(m.throw(o))}catch(g){y(g)}},F=o=>o.done?e(o.value):Promise.resolve(o.value).then(A,_);F((m=m.apply(d,D)).next())});import{d as J,r as x,j as i,o as l,c as p,k as n,w as c,a as t,l as E,t as I,F as V,y as S,x as L,q as h,A as P,J as G,n as H,b as T,_ as K,E as f,p as Q,f as W}from"./index.5a90395c.js";import X from"./basic-info.d9e87cbd.js";import Y from"./follow-records.bcccc358.js";import Z from"./interact-records.4d1bfb99.js";import{h as ee,s as b}from"./account.f146a620.js";import{f as N}from"./dateUtil.67c53eed.js";const U="/user/assets/default-avatar.c8807a12.png";const k=d=>(Q("data-v-a03d0250"),d=d(),W(),d),se={class:"probe-detail"},te={class:"head"},ae={class:"left"},ue=["src"],oe={class:"name-time"},le={style:{margin:"12px 0"}},ne={class:"right"},re=k(()=>t("div",{class:"title"},"\u7528\u6237\u72B6\u6001\uFF1A",-1)),ie={class:"user-type"},ce=["onClick"],de=k(()=>t("div",{class:"title"},"\u7528\u6237\u6807\u7B7E\uFF1A",-1)),me={class:"user-tag"},_e=["onClick"],ve={key:0,class:"user-tag-item"},pe=k(()=>t("i",{class:"el-icon-plus"},null,-1)),fe={class:"detail"},Fe=J({__name:"probeDetail",emits:["saveSuccess"],setup(d,{expose:D,emit:m}){const e=x({defaultAvatar:U,drawer:!1,userTypelist:["\u610F\u5411","\u7559\u8D44","\u5DF2\u6C9F\u901A","\u5DF2\u8DDF\u8FDB","\u5DF2\u5408\u4F5C"],userTypeIndex:0,isAdd:!1,usertaglist:[],userTag:"",customInfo:{},customerBasicInfo:{},activeName:"first"});x({});const y=m,A=()=>{e.value.drawer=!1,y("saveSuccess")},_=()=>B(this,null,function*(){let{code:a,data:s,msg:r}=yield ee({id:e.value.customInfo.id});if(a==200){for(let C in s)Reflect.set(e.value.customerBasicInfo,C,s[C]);e.value.userTypeIndex=s.leads_type,e.value.usertaglist=s.tag_list}else f.error(r)}),F=()=>{e.value.customerBasicInfo={}},o=a=>B(this,null,function*(){if(a===0&&e.value.customerBasicInfo.telephone){f.warning("\u5BA2\u6237\u7559\u4E0B\u8054\u7CFB\u65B9\u5F0F\uFF0C\u4E0D\u53EF\u5207\u6362\u4E3A\u610F\u5411\u5BA2\u6237\uFF01");return}if(a===1&&!e.value.customerBasicInfo.telephone){f.warning("\u5BA2\u6237\u672A\u7559\u8054\u7CFB\u65B9\u5F0F\uFF0C\u4E0D\u53EF\u5207\u6362\u4E3A\u7559\u8D44\u5BA2\u6237\uFF01");return}if(e.value.userTypeIndex!==a){e.value.userTypeIndex=a;let{code:s,msg:r}=yield b({id:e.value.customInfo.id,leads_type:a});s==200?_():f.error(r)}}),g=()=>{e.value.isAdd=!0},$=a=>B(this,null,function*(){e.value.usertaglist.splice(a,1);let{code:s,msg:r}=yield b({id:e.value.customInfo.id,tag_list:e.value.usertaglist});s!=200&&(f.error(r),_())}),z=()=>B(this,null,function*(){if(e.value.userTag.length){e.value.usertaglist.push(e.value.userTag);let{code:a,msg:s}=yield b({id:e.value.customInfo.id,tag_list:e.value.usertaglist});a!=200&&(f.error(s),_())}e.value.userTag="",e.value.isAdd=!1});return D({baseData:e}),(a,s)=>{const r=i("el-avatar"),C=i("CircleCloseFilled"),j=i("el-icon"),M=i("el-input"),w=i("el-tab-pane"),O=i("el-tabs"),R=i("el-drawer");return l(),p("div",null,[n(R,{title:"\u8BE6\u60C5",modelValue:e.value.drawer,"onUpdate:modelValue":s[3]||(s[3]=u=>e.value.drawer=u),direction:"rtl",size:"900","destroy-on-close":!0,"show-close":!0,wrapperClosable:!0,onClose:F,onOpen:_},{default:c(()=>[t("div",se,[t("div",te,[t("div",ae,[n(r,{size:48,src:e.value.customerBasicInfo.avatar,onError:u=>!0},{default:c(()=>[t("img",{src:E(U)},null,8,ue)]),_:1},8,["src"]),t("div",oe,[t("span",le,I(e.value.customerBasicInfo.nickname||"\u6635\u79F0\u83B7\u53D6\u4E2D"),1),t("span",null,"\u66F4\u65B0\u65F6\u95F4\uFF1A"+I(e.value.customerBasicInfo.update_time&&E(N)(e.value.customerBasicInfo.update_time)||"\u6682\u65E0"),1),t("span",null,"\u4E92\u52A8\u65F6\u95F4\uFF1A"+I(e.value.customerBasicInfo.interact_time&&E(N)(e.value.customerBasicInfo.interact_time)||"\u6682\u65E0"),1)])]),t("div",ne,[re,t("div",ie,[(l(!0),p(V,null,S(e.value.userTypelist,(u,v)=>(l(),p("div",{class:L(["user-type-item",{"choose-user-type":v===e.value.userTypeIndex}]),key:v,onClick:q=>o(v)},I(u),11,ce))),128))]),de,t("div",me,[(l(!0),p(V,null,S(e.value.usertaglist,(u,v)=>(l(),p("div",{class:"user-tag-item",key:v},[t("div",{class:"close",onClick:q=>$(v)},[n(j,null,{default:c(()=>[n(C)]),_:1})],8,_e),t("span",null,I(u),1)]))),128)),e.value.isAdd?(l(),p("div",ve,[n(M,{ref:"tagipt",modelValue:e.value.userTag,"onUpdate:modelValue":s[0]||(s[0]=u=>e.value.userTag=u),modelModifiers:{trim:!0},onBlur:z},null,8,["modelValue"])])):h("",!0),P(t("div",{class:"user-tag-item addtag",onClick:g},[pe,H(" \u6DFB\u52A0\u6807\u7B7E")],512),[[G,!e.value.usertaglist||e.value.usertaglist&&e.value.usertaglist.length<6]])])])]),t("div",fe,[n(O,{modelValue:e.value.activeName,"onUpdate:modelValue":s[2]||(s[2]=u=>e.value.activeName=u)},{default:c(()=>[n(w,{label:"\u57FA\u672C\u4FE1\u606F",name:"first"},{default:c(()=>[e.value.activeName==="first"?(l(),T(X,{key:0,customerBasicInfo:e.value.customerBasicInfo,onSaveSuccess:A,onCancel:s[1]||(s[1]=u=>e.value.drawer=!1)},null,8,["customerBasicInfo"])):h("",!0)]),_:1}),n(w,{label:"\u8DDF\u8FDB\u8BB0\u5F55",name:"second"},{default:c(()=>[e.value.activeName==="second"?(l(),T(Y,{key:0,customInfo:e.value.customInfo},null,8,["customInfo"])):h("",!0)]),_:1}),n(w,{label:"\u4E92\u52A8\u8BB0\u5F55",name:"third"},{default:c(()=>[e.value.activeName==="third"?(l(),T(Z,{key:0,account_id:e.value.customInfo.account_id,open_id:e.value.customInfo.open_id},null,8,["account_id","open_id"])):h("",!0)]),_:1})]),_:1},8,["modelValue"])])])]),_:1},8,["modelValue"])])}}}),ge=K(Fe,[["__scopeId","data-v-a03d0250"]]),we=Object.freeze(Object.defineProperty({__proto__:null,default:ge},Symbol.toStringTag,{value:"Module"}));export{we as a,U as d,ge as p};
