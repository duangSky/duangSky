var X=Object.defineProperty,Y=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var z=(t,l,a)=>l in t?X(t,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[l]=a,B=(t,l)=>{for(var a in l||(l={}))$.call(l,a)&&z(t,a,l[a]);if(x)for(var a of x(l))ee.call(l,a)&&z(t,a,l[a]);return t},I=(t,l)=>Y(t,Z(l));var A=(t,l,a)=>new Promise((F,g)=>{var S=i=>{try{h(a.next(i))}catch(m){g(m)}},e=i=>{try{h(a.throw(i))}catch(m){g(m)}},h=i=>i.done?F(i.value):Promise.resolve(i.value).then(S,e);h((a=a.apply(t,l)).next())});import{d as ae,a0 as V,r as _,j as f,v as te,o as p,b as y,w as k,l as u,a as c,t as N,k as v,c as G,y as le,F as H,z as oe,A as re,q as P,_ as se,E as w,p as ie,f as ue}from"./index.5a90395c.js";import{u as ne}from"./mixShear.0f781a9f.js";import{u as ce}from"./material.85a80f57.js";import{I as de}from"./ImportMeterial.9b103172.js";import{P as pe}from"./Pagination.554cb32d.js";import me from"./material-card.f7d63667.js";import{l as _e,a as fe}from"./creative.ea528d59.js";import{t as ve,d as ge,e as he}from"./index.0e306189.js";import"./keyword.011c6f30.js";import"./index.browser.2b0920b0.js";import"./AliCloudUpload.13488d40.js";import"./audio.531569af.js";import"./MediumPreview.37c6af48.js";const Me=t=>(ie("data-v-4ff63af6"),t=t(),ue(),t),De={class:"selectGroup"},Ce={class:"top"},ke={class:"selected"},we={class:"selectMaterial"},ye={class:"top"},Fe={class:"selected"},Se=Me(()=>c("span",null,"\u9009\u62E9\u7D20\u6750",-1)),be={key:1},Ee=ae({__name:"work-material",setup(t,{expose:l}){const a=ne(),F=ce(),{selectMaterals:g,screen:S}=V(F),{form:e,makeData:h}=V(a),i=_(),m=_(),M=_({page:1,limit:18}),b=_(!1),R=_(0),j=_([]),E=()=>A(this,null,function*(){let o=I(B({},M.value),{filter:{type:0},op:{type:"="}}),{code:r,data:n,msg:s}=yield _e(o);r==200?(j.value=n.list,R.value=n.total):w.error(s)});E();const q=o=>{M.value.page=o,E()},J=o=>{M.value.page=1,M.value.limit=o,E()},L=()=>{({1:O,2:()=>w.warning("\u9009\u62E9\u7D20\u6750\u7EC4"),3:()=>{S.value.uploadedData=["video","image"],g.value=e.value.data.Material,m.value.drawer=!0}})[e.value.data.MaterialConfig]()},O=()=>A(this,null,function*(){let o=h.value.zhuci.map(D=>D.name),r={filter:{tags_zhuci:JSON.stringify(o),ratio:[e.value.scene_ratio]},op:{tags_zhuci:"in",ratio:"in"},page:1,limit:1e3};b.value=!0;let{code:n,data:s,msg:d}=yield fe(r);n==200?(s.list.length||w.warning("\u5339\u914D\u7ED3\u679C\u4E3A\u7A7A"),e.value.data.Material=s.list.map(D=>he(D))):w.error(d),b.value=!1}),T=o=>{if(!o)return;let r=[...e.value.data.Material,...g.value],n={};e.value.data.Material=r.reduce((s,d)=>(n[d.id]||(n[d.id]=s.push(d)),s),[]).map(s=>ge(s)),w.success("\u7D20\u6750\u5BFC\u5165\u6210\u529F")},U=o=>{e.value.data.Material=e.value.data.Material.filter(r=>r.id!==o.id)};return l({formRef:i}),(o,r)=>{const n=f("el-option"),s=f("el-select"),d=f("el-form-item"),D=f("DArrowRight"),K=f("el-icon"),Q=f("el-form"),W=te("loading");return p(),y(Q,{class:"inForm",ref_key:"formRef",ref:i,model:u(e),rules:u(ve),"label-width":"82"},{default:k(()=>[u(e).data.MaterialConfig===2?(p(),y(d,{key:0,label:"\u5DF2\u9009\u7D20\u6750\u7EC4",style:{"align-items":"center"},prop:"data.MaterialGroup"},{default:k(()=>[c("div",De,[c("div",Ce,[c("span",ke,"\u5DF2\u9009\uFF1A"+N(u(e).data.MaterialGroup.length),1),v(s,{modelValue:u(e).data.MaterialGroup,"onUpdate:modelValue":r[1]||(r[1]=C=>u(e).data.MaterialGroup=C),teleported:!1,multiple:"","multiple-limit":5,clearable:"",placeholder:"\u8BF7\u9009\u62E9\u7D20\u6750\u7EC4"},{default:k(()=>[(p(!0),G(H,null,le(j.value,C=>(p(),y(n,{key:C.id,value:C.id,label:C.name},null,8,["value","label"]))),128)),c("div",{class:"foot",onClick:r[0]||(r[0]=oe(()=>{},["stop"]))},[v(pe,{pages:M.value,total:R.value,hideSingle:!0,layout:"total, prev, pager, next, jumper",onHandleCurrentChange:q,onHandleSizeChange:J},null,8,["pages","total"])])]),_:1},8,["modelValue"])])])]),_:1})):re((p(),y(d,{key:1,label:"\u5DF2\u9009\u7D20\u6750",prop:"data.Material"},{default:k(()=>[c("div",we,[c("div",ye,[c("span",Fe,"\u5DF2\u9009\uFF1A"+N(u(e).data.Material.length),1),c("div",{class:"pick",onClick:L},[u(e).data.MaterialConfig===3?(p(),G(H,{key:0},[Se,v(K,null,{default:k(()=>[v(D)]),_:1})],64)):P("",!0),u(e).data.MaterialConfig===1?(p(),G("span",be,"\u667A\u80FD\u5339\u914D")):P("",!0)])]),v(me,{materials:u(e).data.Material,onHandleDelete:U},null,8,["materials"])])]),_:1})),[[W,b.value,void 0,{fullscreen:!0,lock:!0}]]),v(de,{ref_key:"meterialRef",ref:m,onCloseDrawer:T},null,512)]),_:1},8,["model","rules"])}}}),Le=se(Ee,[["__scopeId","data-v-4ff63af6"]]);export{Le as default};
