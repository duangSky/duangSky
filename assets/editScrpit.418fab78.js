var g=(b,m,n)=>new Promise((c,r)=>{var u=o=>{try{d(n.next(o))}catch(p){r(p)}},F=o=>{try{d(n.throw(o))}catch(p){r(p)}},d=o=>o.done?c(o.value):Promise.resolve(o.value).then(u,F);d((n=n.apply(b,m)).next())});import{_ as B,d as C,i as T,h as w,r as S,j as h,v as k,o as y,b as N,w as v,a as D,k as _,n as E,A as V,c as j,E as f}from"./index.5a90395c.js";import{l as $}from"./lodash.a9e36c73.js";import q from"./script-table.54b535ff.js";import{m as M,u as P}from"./make.3dd199c4.js";import"./material.85a80f57.js";import"./creative.ea528d59.js";import"./keyword.011c6f30.js";import"./ImportMeterial.9b103172.js";import"./index.browser.2b0920b0.js";import"./AliCloudUpload.13488d40.js";import"./Pagination.554cb32d.js";import"./audio.531569af.js";import"./AIToolPop.b04822dd.js";import"./useCopyToClipboard.fba770f6.js";import"./aitools.ae73576d.js";const R={class:"top"},W={class:"edit_table"},H={class:"add"},I=C({__name:"editScrpit",setup(b){const m=T(),n=w(),c=S(""),r=S([]),u=S(!1);(()=>g(this,null,function*(){u.value=!0;let{code:a,data:i,msg:s}=yield M({id:m.query.id});a==200?(c.value=i.name,r.value=i.data.map(t=>(t.Subtitle=t.Subtitle.map((e,l)=>`${l+1}.${e}`).join(`
`),t.Title=t.Title.map((e,l)=>`${l+1}.${e}`).join(`
`),t))):f.error(s),u.value=!1}))();const d=()=>{r.value.push({Audio:[],Material:[],Name:"",Note:"",Subtitle:"",Title:""})},o=a=>{r.value.splice(a,1)},p=(a,i)=>{let s=[];return a[i]&&(s=a[i].split(`
`).map((t,e)=>{let l=(e+1).toString();return t=t.split("").slice(l.length+1).join(""),t})),s},x=()=>g(this,null,function*(){let a=!0;const i=$.exports.cloneDeep(r.value).map(e=>(e.Subtitle=p(e,"Subtitle"),e.Title=p(e,"Title"),e.Subtitle.length!==e.Title.length&&(a=!1),e));if(!a)return f.warning("\u8BF7\u4FDD\u6301\u6BCF\u4E2A\u573A\u666F\u6807\u9898\u6570\u548C\u6587\u6848\u6570\u4E00\u81F4");u.value=!0;let{code:s,msg:t}=yield P({id:m.query.id,name:c.value,data:i});s==200?(f.success("\u4FEE\u6539\u6210\u529F"),n.back()):f.error(t),u.value=!1});return(a,i)=>{const s=h("el-input"),t=h("el-button"),e=h("PageWrapper"),l=k("loading");return y(),N(e,{regain:"\u811A\u672C\u7F16\u8F91"},{default:v(()=>[D("div",R,[_(s,{modelValue:c.value,"onUpdate:modelValue":i[0]||(i[0]=A=>c.value=A),style:{width:"360px"}},null,8,["modelValue"]),_(t,{type:"primary",loading:u.value,onClick:x},{default:v(()=>[E("\u4FDD\u5B58")]),_:1},8,["loading"])]),V((y(),j("div",W,[_(q,{edits:r.value,onHandleDeleteScene:o},null,8,["edits"]),D("div",H,[_(t,{type:"primary",onClick:d},{default:v(()=>[E("\u6DFB\u52A0\u573A\u666F")]),_:1})])])),[[l,u.value]])]),_:1})}}}),re=B(I,[["__scopeId","data-v-0ed6a154"]]);export{re as default};
