var D=(m,U,C)=>new Promise((E,b)=>{var V=p=>{try{x(C.next(p))}catch(F){b(F)}},v=p=>{try{x(C.throw(p))}catch(F){b(F)}},x=p=>p.done?E(p.value):Promise.resolve(p.value).then(V,v);x((C=C.apply(m,U)).next())});import{d as de,a0 as z,r as f,T as N,j as g,o,b as i,w as c,c as s,y,a as d,l as R,t as w,k as h,n as ce,F as r,q as k,z as se,_ as ie,E as A,p as re,f as pe,B as me}from"./index.5a90395c.js";import{l as P}from"./lodash.a9e36c73.js";import{u as _e}from"./publish.6bf25757.js";import{u as he}from"./imgTextPublish.0e57f47f.js";import{g as fe,j as ye,k as ge}from"./index.101c175c.js";import{m as j,c as L,d as ke}from"./publish.8b41f428.js";import{n as Ce}from"./account.f146a620.js";import Ve from"./select-place.c3281a39.js";import xe from"./mount-applet-pop.0bd6e464.js";const B=m=>(re("data-v-0a3cadc2"),m=m(),pe(),m),Fe={class:"configItem"},be={class:"info"},ve=["src"],Ae={class:"name text-ellipsis-1"},Be={class:"emplace"},Ee={class:"head"},De=B(()=>d("div",{class:"left"},[d("span",null,"\u6DFB\u52A0\u951A\u70B9")],-1)),we={class:"operate"},Pe=["onClick"],Ue=["onClick"],Ie=B(()=>d("div",null,"@\u8D26\u53F7",-1)),Se=B(()=>d("div",null,"\u6DFB\u52A0\u5408\u96C6",-1)),Te=B(()=>d("div",null,"\u9891\u9053",-1)),Oe=B(()=>d("div",null,"\u9891\u9053",-1)),Me=de({__name:"account-config",props:{accounts:{type:Array,default:[]},pattern:{type:String,default:"video"}},setup(m){const U=_e(),C=he(),{form:E}=z(U),{form:b}=z(C),V=f([]),v=f(),x=f(""),p=f([]),F=f([]),M=f(""),I=f([]),$=f([]),S=f([]),T=m;(()=>{Promise.all([j({form:"applet",type:"douyin"}),L({type:"bilibili"}),L({type:"zhihu"})]).then(l=>{console.log(l);let t=l.find(n=>n.code!==200);t&&A.error(t.msg),V.value=l[0].data,p.value=l[1].data,I.value=l[2].data})})();const q=()=>D(this,null,function*(){let{code:l,data:t,msg:n}=yield j({form:"applet",type:"douyin"});l==200?V.value=t:A.error(n)}),H=l=>{O.value.forEach(t=>{t.atuser=l.atuser,t.checkedPosOrApplet=l.checkedPosOrApplet,t.extra_micro=P.exports.cloneDeep(l.extra_micro),t.extra_poi=P.exports.cloneDeep(l.extra_poi),t.extra_link=P.exports.cloneDeep(l.extra_link)})},G=l=>{v.value.accountId=l.id,v.value.dialogVisible=!0},J=({accountId:l,form:t})=>{let n=O.value.find(u=>u.id===l);n.extra_micro=t},K=l=>{me.alert("\u786E\u5B9A\u5220\u9664\u8BE5\u5C0F\u7A0B\u5E8F\uFF1F","\u63D0\u793A",{type:"warning",showCancelButton:!0}).then(()=>D(this,null,function*(){console.log("\u5220\u9664\u5C0F\u7A0B\u5E8F");let{code:t,msg:n}=yield ke({form:"applet",type:"douyin",id:l.id});t==200?(A.success("\u5220\u9664\u6210\u529F"),q()):A.error(n)})).catch(()=>{console.log("\u53D6\u6D88\u5220\u9664")})},Q=l=>{l.extra_micro={micro_app_id:"",micro_app_title:"",micro_app_url:""},l.extra_poi={poi_id:"",poi_name:"",address:""}},W=(l,t)=>{let n=V.value.find(u=>u.id===l);t.extra_micro.micro_app_title=n.name,t.extra_micro.micro_app_url=n.path,t.extra_micro.micro_app_id=n.appid},X=(l,t)=>{t.channelId="";let n=p.value.find(u=>u.id===l);F.value=n.children},Y=(l,t)=>{t.channelId="";let n=I.value.find(u=>u.id===l);$.value=n.children},Z=(l,t)=>D(this,null,function*(){if(l){let{code:n,data:u,msg:_}=yield Ce({id:t.id});n==200?S.value=u:A.error(_)}else S.value=[]}),ee=l=>{let t=T.pattern==="video"?E:b;t.value.data.Account=t.value.data.Account.filter(n=>n.id!==l.id)},O=N(()=>(T.pattern==="video"?E:b).value.data.Account.filter(t=>t.type==="douyin"||t.type==="bilibili"||t.type==="zhihu")),le=N(()=>{let l=P.exports.cloneDeep(ge);return T.pattern==="imgText"&&l.push({value:"urls",label:"\u5546\u54C1"}),l});return(l,t)=>{const n=g("el-button"),u=g("el-option"),_=g("el-select"),te=g("CircleClose"),ae=g("el-icon"),oe=g("el-input"),ne=g("el-col"),ue=g("el-row");return o(),i(ue,null,{default:c(()=>[(o(!0),s(r,null,y(O.value,a=>(o(),i(ne,{key:a.accountId,xl:12,lg:12,md:24,sm:24,xs:24},{default:c(()=>[d("div",Fe,[d("div",be,[d("img",{src:R(fe)(a.type),alt:""},null,8,ve),d("div",Ae,w(a.nickname),1),h(n,{plain:"",onClick:e=>ee(a)},{default:c(()=>[ce("\u5220\u9664")]),_:2},1032,["onClick"])]),d("div",Be,[a.type==="douyin"?(o(),s(r,{key:0},[d("div",Ee,[De,d("div",we,[a.checkedPosOrApplet==="applet"?(o(),s("span",{key:0,onClick:e=>G(a)},"\u6302\u8F7D\u5C0F\u7A0B\u5E8F",8,Pe)):k("",!0),d("span",{onClick:e=>H(a)},"\u540C\u6B65\u914D\u7F6E",8,Ue)])]),h(_,{modelValue:a.checkedPosOrApplet,"onUpdate:modelValue":e=>a.checkedPosOrApplet=e,placeholder:"\u8BF7\u9009\u62E9",style:{"margin-right":"2%",width:"30%"},onChange:e=>Q(a)},{default:c(()=>[(o(!0),s(r,null,y(le.value,e=>(o(),i(u,{key:e.value,value:e.value,label:e.label},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]),a.checkedPosOrApplet==="applet"?(o(),i(_,{key:0,modelValue:a.extra_micro.micro_app_title,"onUpdate:modelValue":e=>a.extra_micro.micro_app_title=e,placeholder:"\u8BF7\u9009\u62E9\u5C0F\u7A0B\u5E8F",style:{width:"68%"},onChange:e=>W(e,a)},{default:c(()=>[(o(!0),s(r,null,y(V.value,e=>(o(),i(u,{key:e.id,value:e.id,label:e.name},{default:c(()=>[d("span",null,w(e.name),1),e.id.indexOf("system:")===-1?(o(),i(ae,{key:0,onClick:se(ze=>K(e),["stop"])},{default:c(()=>[h(te)]),_:2},1032,["onClick"])):k("",!0)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):k("",!0),a.checkedPosOrApplet==="position"?(o(),i(Ve,{key:1,account:a},null,8,["account"])):k("",!0),a.checkedPosOrApplet==="urls"?(o(),i(oe,{key:2,modelValue:a.extra_link.link,"onUpdate:modelValue":e=>a.extra_link.link=e,placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u94FE\u63A5",style:{width:"68%"}},null,8,["modelValue","onUpdate:modelValue"])):k("",!0),m.pattern==="video"?(o(),s(r,{key:3},[Ie,h(_,{modelValue:a.atuser,"onUpdate:modelValue":e=>a.atuser=e,placeholder:"\u8BF7\u9009\u62E9\u8D26\u53F7",style:{width:"100%"}},{default:c(()=>[(o(!0),s(r,null,y(m.accounts,e=>(o(),i(u,{key:e.id,value:e.id,label:e.nickname},{default:c(()=>[d("span",null,w(`\u3010${R(ye)(e.type)}\u3011 ${e.nickname}`),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])],64)):k("",!0),m.pattern==="imgText"?(o(),s(r,{key:4},[Se,h(_,{modelValue:a.atuser,"onUpdate:modelValue":e=>a.atuser=e,placeholder:"\u8BF7\u9009\u62E9\u5408\u96C6",style:{width:"100%"},onVisibleChange:e=>Z(e,a)},{default:c(()=>[(o(!0),s(r,null,y(S.value,e=>(o(),i(u,{key:e.id,value:e.id,label:e.mix_name},{default:c(()=>[d("span",null,w(e.mix_name),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onVisibleChange"])],64)):k("",!0)],64)):a.type==="bilibili"?(o(),s(r,{key:1},[Te,h(_,{modelValue:x.value,"onUpdate:modelValue":t[0]||(t[0]=e=>x.value=e),placeholder:"\u8BF7\u9009\u62E9\u9891\u9053",style:{width:"100%"},onChange:e=>X(e,a)},{default:c(()=>[(o(!0),s(r,null,y(p.value,e=>(o(),i(u,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onChange"]),h(_,{modelValue:a.channelId,"onUpdate:modelValue":e=>a.channelId=e,placeholder:"\u8BF7\u9009\u62E9\u9891\u9053",style:{"margin-top":"16px",width:"100%"}},{default:c(()=>[(o(!0),s(r,null,y(F.value,e=>(o(),i(u,{key:e.id,label:e.name,value:e.tid},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])],64)):a.type==="zhihu"?(o(),s(r,{key:2},[Oe,h(_,{modelValue:M.value,"onUpdate:modelValue":t[1]||(t[1]=e=>M.value=e),placeholder:"\u8BF7\u9009\u62E9\u6240\u5C5E\u9886\u57DF",style:{width:"100%"},onChange:e=>Y(e,a)},{default:c(()=>[(o(!0),s(r,null,y(I.value,e=>(o(),i(u,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onChange"]),h(_,{modelValue:a.channelId,"onUpdate:modelValue":e=>a.channelId=e,placeholder:"\u8BF7\u9009\u62E9\u6240\u5C5E\u9886\u57DF",style:{"margin-top":"16px",width:"100%"}},{default:c(()=>[(o(!0),s(r,null,y($.value,e=>(o(),i(u,{key:e.id,label:e.name,value:e.tid},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])],64)):k("",!0)])])]),_:2},1024))),128)),h(xe,{ref_key:"mountAppletRef",ref:v,onHandleDefineMount:J},null,512)]),_:1})}}}),We=ie(Me,[["__scopeId","data-v-0a3cadc2"]]);export{We as default};
