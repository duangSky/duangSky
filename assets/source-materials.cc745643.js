var ve=Object.defineProperty,fe=Object.defineProperties;var ge=Object.getOwnPropertyDescriptors;var ne=Object.getOwnPropertySymbols;var he=Object.prototype.hasOwnProperty,Fe=Object.prototype.propertyIsEnumerable;var ie=(e,t,n)=>t in e?ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,re=(e,t)=>{for(var n in t||(t={}))he.call(t,n)&&ie(e,n,t[n]);if(ne)for(var n of ne(t))Fe.call(t,n)&&ie(e,n,t[n]);return e},ce=(e,t)=>fe(e,ge(t));var de=(e,t,n)=>new Promise((x,p)=>{var h=r=>{try{F(n.next(r))}catch(C){p(C)}},b=r=>{try{F(n.throw(r))}catch(C){p(C)}},F=r=>r.done?x(r.value):Promise.resolve(r.value).then(h,b);F((n=n.apply(e,t)).next())});import{_ as H,r as E,j as g,v as se,o as d,c as w,x as pe,a as l,k as u,w as c,n as I,t as B,q as Ce,A as V,F as G,y as U,p as Q,f as Z,d as ue,T as R,J as L,I as ye,u as Ee,U as we,b as D,l as i,E as N,D as be,G as ke,a0 as $e,a3 as xe}from"./index.5a90395c.js";import{u as De}from"./material.85a80f57.js";import Be from"./material-structure.99435468.js";import Se from"./waterfall-flow.399a1b0f.js";import{n as Ae}from"./index.browser.2b0920b0.js";import{_ as Ge}from"./AliCloudUpload.13488d40.js";import{l as Ve}from"./creative.ea528d59.js";import{Q as Ie}from"./index.1143cf66.js";import{P as Me}from"./Pagination.554cb32d.js";import{Z as Ue}from"./config.d0c812d6.js";import"./keyword.011c6f30.js";import"./MediumPreview.37c6af48.js";import"./dateUtil.67c53eed.js";import"./edit-tags-pop.0a6796bf.js";import"./edit-media-pop.f608703f.js";import"./segment-media-pop.cfad6649.js";import"./cut-media-pop.faccb4e7.js";import"./useModal.fe9d85cc.js";import"./base64Conver.96a5c530.js";import"./move-media-pop.366157bc.js";import"./audio.531569af.js";import"./downloadFile.9a38d16c.js";import"./download.71eecab8.js";const Pe=e=>(Q("data-v-8452cf86"),e=e(),Z(),e),Te={class:"material_group"},je={class:"name"},Ne=Pe(()=>l("span",null,"\u5168\u90E8",-1)),ze={class:"num"},qe={"infinite-scroll-immediate":!1},Oe=["onClick"],Re={class:"name"},Le={class:"text-ellipsis-1"},He={class:"num"},Qe={__name:"material-group",props:{showAll:{type:Boolean,default:!0},groupId:{type:String,default:!0},fileGroup:{type:Array,default:[]},fileTotal:{type:Number,default:0},activeName:{type:String,required:!0}},emits:["nextPage","switchGroup"],setup(e,{emit:t}){const n=t;E();const x=h=>{n("switchGroup",h)},p=()=>{n("nextPage")};return(h,b)=>{const F=g("FolderOpened"),r=g("el-icon"),C=g("el-scrollbar"),m=se("infinite-scroll");return d(),w("div",Te,[e.showAll?(d(),w("div",{key:0,class:pe(["all",{select:e.groupId===""}]),onClick:b[0]||(b[0]=k=>x(""))},[l("div",je,[u(r,null,{default:c(()=>[u(F)]),_:1}),I("\xA0 "),Ne]),l("div",ze,B(e.fileTotal),1)],2)):Ce("",!0),u(C,{class:"filelist"},{default:c(()=>[V((d(),w("div",qe,[(d(!0),w(G,null,U(e.fileGroup,k=>(d(),w("div",{class:pe(["item",{select:e.groupId===k.id}]),key:k.id,onClick:v=>x(k.id)},[l("div",Re,[u(r,null,{default:c(()=>[u(F)]),_:1}),I("\xA0 "),l("span",Le,B(k.name),1)]),l("div",He,[l("span",null,B(k.medianum),1)])],10,Oe))),128))])),[[m,p]])]),_:1})])}}},Ze=H(Qe,[["__scopeId","data-v-8452cf86"]]);const Je=e=>(Q("data-v-c4933946"),e=e(),Z(),e),We={class:"item"},Ke={class:"img"},Xe=["src"],Ye={class:"md5"},el={class:"upload"},ll=Je(()=>l("span",null,"\u89E3\u7801\u4E2D",-1)),ol={class:"encode","element-loading-background":"rgba(0, 0, 0, .3)","element-loading-text":"\u89E3\u7801\u4E2D"},tl={class:"name"},al={class:"text-ellipsis-1"},sl=ue({__name:"upload-list",props:{file:{type:Object,default:{}}},setup(e){const t=e,n=()=>{t.file.reader.abort()},x=R(()=>t.file.progressMd5<100),p=R(()=>t.file.progressMd5===100&&t.file.uploadProgress>0&&t.file.uploadProgress<100),h=R(()=>(t.file.uploadProgress===0||t.file.uploadProgress===100)&&!t.file.uploadSuccess);return(b,F)=>{const r=g("el-progress"),C=se("loading");return d(),w("div",We,[l("div",Ke,[V(l("img",{src:e.file.cover_url,alt:""},null,8,Xe),[[L,e.file.cover_url]]),V(l("div",Ye,[u(r,{"stroke-width":8,percentage:e.file.progressMd5},null,8,["percentage"]),l("span",{onClick:n},"\u53D6\u6D88\u4E0A\u4F20")],512),[[L,x.value]]),V(l("div",el,[u(r,{type:"circle",color:"#5480FF","stroke-width":8,percentage:e.file.uploadProgress},null,8,["percentage"]),ll],512),[[L,p.value]]),V(l("div",ol,null,512),[[C,h.value]])]),l("div",tl,[l("span",al,B(e.file.name),1)])])}}}),ul=H(sl,[["__scopeId","data-v-c4933946"]]);const J=e=>(Q("data-v-0f609fc6"),e=e(),Z(),e),nl={class:"content"},il={class:"left"},rl=J(()=>l("div",{class:"save"},"\u4FDD\u5B58\u4F4D\u7F6E",-1)),cl={class:"right"},dl={class:"top"},pl={class:"file"},_l={class:"num"},ml=J(()=>l("div",{class:"clear"},"\u6E05\u7A7A\u5168\u90E8",-1)),vl={style:{display:"block","text-align":"center","max-width":"170px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",margin:"0 auto"}},fl={style:{display:"block","text-align":"center","max-width":"170px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",margin:"0 auto"}},gl=J(()=>l("i",{class:"iconfont icon-plus-square"},null,-1)),hl=J(()=>l("div",{class:"txt"},[l("span",null,"\u652F\u6301\u4E0A\u4F20mov\u3001mp4\u3001mp3\u3001jpg\u3001png\u3001jpeg\u683C\u5F0F\uFF0C\u5355\u4E2A\u6587\u4EF6\u5927\u5C0F\u4E0D\u8D85\u8FC71GB")],-1)),Fl=[gl,hl],Cl="audio/wav,audio/mp3,audio/mpeg,image/png,image/jpeg,image/jpg,.mov,video/mp4",yl=ue({__name:"UploadMaterials",emits:["closeDrawer"],setup(e,{expose:t,emit:n}){const{VITE_NODE_ENV:x}=ye(),p=Ee(),h=E(!1),b=E("\u7D20\u6750\u4E0A\u4F20\uFF08\u652F\u6301\u76F4\u63A5\u9009\u53D6\u6587\u4EF6\u5939\u6216\u6587\u4EF6\uFF09"),F=E(),r=E([]),C=E(0),m=E(""),k=E({page:1,limit:18}),v=E([]),P=n,S={Title:"\u4E1C\u65B9\u89C2\u90B8",Description:"\u4E1C\u65B9\u89C2\u90B8",Tags:"\u4E1C\u65B9\u89C2\u90B8",BusinessType:"default"},z=()=>de(this,null,function*(){let o=ce(re({},k.value),{filter:{type:0},op:{type:"="}});const{code:s,data:_,msg:$}=yield Ve(o);s==200?(r.value=[...r.value,..._.list],C.value=_.total,k.value.page===1&&!m.value&&(m.value=_.list[0].id)):N.error($)}),T=()=>{r.value=[],z()},j=()=>{r.value.length<C.value&&(k.value.page++,z())},W=o=>{m.value=o},K=o=>o.length>100?(N.warning("\u6700\u591A\u652F\u6301100\u4E2A!"),!1):(o.forEach(s=>{s.f_id=Ae(6),v.value.push({f_id:s.f_id,progressMd5:0,uploadProgress:0,uploadSuccess:!1,name:s.name})}),!0),A=(o,s)=>{let _=v.value.find($=>$.f_id===o.f_id);_.reader=o.reader,_.progressMd5=s},X=o=>{v.value=v.value.filter(s=>s.f_id!==o.f_id),N.success("\u5DF2\u53D6\u6D88")},Y=(o,s,_)=>{let $=v.value.find(M=>M.f_id===_.file.f_id);$.uploadProgress=o,console.log("\u4E0A\u4F20\u8FDB\u5EA6\uFF1A",o,"\u6587\u4EF6\u5927\u5C0F\uFF1A",s)},ee=o=>{v.value=v.value.filter(s=>s.f_id!==o.f_id)},le=(o,s)=>{let _=v.value.find($=>$.f_id===o.f_id);console.log(o,_,"=====> \u4E0A\u4F20\u6210\u529F"),_.uploadSuccess=!0,_.cover_url=s.cover_url};we(v,o=>{o.length&&o.every(_=>_.uploadSuccess)&&(console.log("\u5168\u90E8\u4E0A\u4F20\u5B8C\u6BD5",o),h.value=!1)},{deep:!0});const q=()=>{if(!m.value)return N.warning("\u8BF7\u5148\u521B\u5EFA\u7D20\u6750\u7EC4");let o="";x==="development"?o="http://admin.dev.devapi.o668.com":o=window.location.origin,y.value=`${o}/scanCode/#/?token=${be}&groupid=${m.value}&name=${f.value}&t=${ke().unix()}`},oe=()=>{v.value=[],P("closeDrawer",m.value)},te=()=>{if(!m.value)return N.warning("\u8BF7\u5148\u521B\u5EFA\u7D20\u6750\u7EC4");F.value.handleFileClick()},y=E(""),f=R(()=>{var o;return(o=r.value.find(s=>s.id===m.value))==null?void 0:o.name});return t({drawer:h,groupId:m}),(o,s)=>{const _=g("el-button"),$=g("el-popover"),M=g("el-col"),ae=g("el-row"),a=g("el-scrollbar"),me=g("el-drawer");return d(),D(me,{modelValue:h.value,"onUpdate:modelValue":s[0]||(s[0]=O=>h.value=O),size:"70%",title:b.value,"destroy-on-close":"","close-on-click-modal":!1,onOpen:T,onClosed:oe},{default:c(()=>[l("div",nl,[l("div",il,[rl,u(Ze,{showAll:!1,groupId:m.value,fileGroup:r.value,fileTotal:C.value,activeName:"first",onNextPage:j,onSwitchGroup:W},null,8,["groupId","fileGroup","fileTotal"])]),l("div",cl,[l("div",dl,[l("div",pl,[l("div",_l,[l("span",null,B(v.value.length)+"/100",1),I(" \u7D20\u6750\u6570\u91CF ")]),ml]),m.value?(d(),D($,{key:0,placement:"bottom",title:"",width:"200",trigger:"click"},{reference:c(()=>[u(_,{type:"primary",onClick:q},{default:c(()=>[I("\u626B\u7801\u4E0A\u4F20")]),_:1})]),default:c(()=>[u(i(Ie),{value:y.value,width:175},null,8,["value"]),l("span",vl,B(f.value),1),l("span",fl,"\uFF08"+B(i(p).info.companyname)+"\uFF09",1)]),_:1})):(d(),D(_,{key:1,type:"primary",onClick:q},{default:c(()=>[I("\u626B\u7801\u4E0A\u4F20")]),_:1}))]),u(a,{class:"list"},{default:c(()=>[u(ae,{gutter:10},{default:c(()=>[u(M,{span:6},{default:c(()=>[u(Ge,{ref_key:"fileUpload",ref:F,groupId:m.value,multiple:!0,mediaMetaData:S,accept:Cl,beforeUpload:K,md5Progress:A,md5Cancel:X,progressUpload:Y,uploadRepeat:ee,uploadSuccessed:le},{fileUpload:c(()=>[l("div",{class:"upload",onClick:te},Fl)]),_:1},8,["groupId"])]),_:1}),(d(!0),w(G,null,U(v.value,O=>(d(),D(M,{span:6,key:O.id},{default:c(()=>[u(ul,{file:O},null,8,["file"])]),_:2},1024))),128))]),_:1})]),_:1})])])]),_:1},8,["modelValue","title"])}}}),El=H(yl,[["__scopeId","data-v-0f609fc6"]]);const _e=e=>(Q("data-v-77d0c5cf"),e=e(),Z(),e),wl={class:"S_header"},bl=_e(()=>l("i",{class:"iconfont icon-plus-square"},null,-1)),kl=_e(()=>l("span",null,"\u4E0A\u4F20\u7D20\u6750",-1)),$l={class:"S_main"},xl={class:"allCheckbox"},Dl={class:"ml-4"},Bl={class:"num"},Sl={class:"S_footer"},Al=ue({__name:"source-materials",emits:["replaceGroup","replaceMoveGroup"],setup(e,{emit:t}){const n=De(),{loading:x,screen:p,groupId:h,pages:b,system_tags:F,keywords:r,materials:C,total:m,isBulk:k,checklist:v,checkAll:P}=$e(n),{getlistMedia:S,handleCheckAllChange:z}=n,T=t,j=E(),W=E([{value:"",label:"\u5168\u90E8"},{value:"video",label:"\u89C6\u9891"},{value:"image",label:"\u56FE\u7247"},{value:"audio",label:"\u97F3\u4E50"}]),K=E([{value:"",label:"\u5168\u90E8\u6BD4\u4F8B"},{value:"9:16",label:"9:16"},{value:"16:9",label:"16:9"},{value:"4:3",label:"4:3"},{value:"1:1",label:"1:1"}]);S();const A=()=>{S()},X=y=>{b.value.page=1,b.value.limit=y,S()},Y=()=>{A()},ee=()=>{h.value&&(j.value.groupId=h.value),j.value.drawer=!0},le=y=>{b.value.page=y,S()},q=y=>{T("replaceMoveGroup",y)},oe=y=>{T("replaceGroup",y)},te=y=>{S(),T("replaceGroup",y)};return(y,f)=>{const o=g("el-option"),s=g("el-select"),_=g("el-cascader"),$=g("el-button"),M=g("el-checkbox"),ae=se("loading");return d(),w(G,null,[u(Be,null,{header:c(()=>[l("div",wl,[u(s,{modelValue:i(p).type,"onUpdate:modelValue":f[0]||(f[0]=a=>i(p).type=a),style:{width:"120px"},onChange:A},{default:c(()=>[(d(!0),w(G,null,U(W.value,a=>(d(),D(o,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),u(s,{modelValue:i(p).ratio,"onUpdate:modelValue":f[1]||(f[1]=a=>i(p).ratio=a),style:{width:"120px"},onChange:A},{default:c(()=>[(d(!0),w(G,null,U(K.value,a=>(d(),D(o,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),u(_,{modelValue:i(p).tags_zhuci,"onUpdate:modelValue":f[2]||(f[2]=a=>i(p).tags_zhuci=a),style:{flex:"1"},placeholder:"\u8BF7\u9009\u62E9\u5173\u952E\u8BCD\u6807\u7B7E",options:i(r),"show-all-levels":!1,props:i(Ue),clearable:"",onChange:Y},null,8,["modelValue","options","props"]),u(s,{modelValue:i(p).tags_miaoshu,"onUpdate:modelValue":f[3]||(f[3]=a=>i(p).tags_miaoshu=a),style:{flex:"1"},multiple:"",placeholder:"\u8BF7\u9009\u62E9\u7D20\u6750\u63CF\u8FF0\u6807\u7B7E",clearable:"",onChange:A},{default:c(()=>[(d(!0),w(G,null,U(i(F).miaoshu,a=>(d(),D(o,{key:a.name,label:a.name,value:a.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),u(s,{modelValue:i(p).tags_jingtou,"onUpdate:modelValue":f[4]||(f[4]=a=>i(p).tags_jingtou=a),style:{flex:"1"},multiple:"",placeholder:"\u8BF7\u9009\u62E9\u955C\u5934\u6807\u7B7E",clearable:"",onChange:A},{default:c(()=>[(d(!0),w(G,null,U(i(F).jingtou,a=>(d(),D(o,{key:a.name,label:a.name,value:a.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),u($,{type:"primary",onClick:ee},{default:c(()=>[bl,kl]),_:1})])]),main:c(()=>[V((d(),w("div",$l,[V(l("div",xl,[u(M,{modelValue:i(P),"onUpdate:modelValue":f[5]||(f[5]=a=>xe(P)?P.value=a:null),onChange:i(z)},{default:c(()=>[I("\u5168\u9009")]),_:1},8,["modelValue","onChange"]),l("div",Dl,[I("\u5DF2\u9009 "),l("span",Bl,B(i(v).length),1)])],512),[[L,i(k)]]),u(Se,{imgs:i(C),onReplaceGroup:oe,onReplaceMoveGroup:q},null,8,["imgs"])])),[[ae,i(x)]])]),footer:c(()=>[l("div",Sl,[u(Me,{pages:i(b),total:i(m),hideSingle:"",pageSizes:[50,100,200],onHandleSizeChange:X,onHandleCurrentChange:le},null,8,["pages","total"])])]),_:1}),u(El,{ref_key:"uploadMater",ref:j,onCloseDrawer:te},null,512)],64)}}}),oo=H(Al,[["__scopeId","data-v-77d0c5cf"]]);export{oo as default};
