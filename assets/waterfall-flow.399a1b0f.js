var D=(h,B,f)=>new Promise((C,M)=>{var F=r=>{try{x(f.next(r))}catch(b){M(b)}},v=r=>{try{x(f.throw(r))}catch(b){M(b)}},x=r=>r.done?C(r.value):Promise.resolve(r.value).then(F,v);x((f=f.apply(h,B)).next())});import{d as me,r as m,a0 as pe,U as _e,T as N,j as n,o as a,c as s,k as o,w as i,F as V,y as H,a as p,A as fe,J as ge,l as w,t as g,b as A,q as _,z as ke,n as k,O as q,a3 as he,_ as ye,E as L,a4 as we}from"./index.5a90395c.js";import{n as Ce}from"./index.browser.2b0920b0.js";import{u as Me}from"./material.85a80f57.js";import{d as Fe}from"./creative.ea528d59.js";import{M as ve}from"./MediumPreview.37c6af48.js";import{g as xe}from"./dateUtil.67c53eed.js";import be from"./edit-tags-pop.0a6796bf.js";import $e from"./edit-media-pop.f608703f.js";import Ae from"./segment-media-pop.cfad6649.js";import Re from"./cut-media-pop.faccb4e7.js";import Ee from"./move-media-pop.366157bc.js";import{A as O}from"./audio.531569af.js";import{d as Ve}from"./downloadFile.9a38d16c.js";import"./keyword.011c6f30.js";import"./config.d0c812d6.js";import"./useModal.fe9d85cc.js";import"./base64Conver.96a5c530.js";import"./Pagination.554cb32d.js";const Be=["onClick"],Ie=["src"],Te=["src"],Pe={class:"tags"},Se={class:"type"},ze={key:3},Ge={class:"info"},De={key:0},Ne={class:"name"},je={class:"txt text-ellipsis-1"},Ue=me({__name:"waterfall-flow",props:{columns:{type:Number,default:6},imgs:{type:Array,default:[]}},emits:["replaceGroup","replaceMoveGroup"],setup(h,{emit:B}){const f=m(),C=m(),M=Me(),{isBulk:F,checklist:v,groupId:x}=pe(M),{handleChangeCheckbox:r,getlistMedia:b}=M,j=B,I=m(),T=m(),P=m(),R=m(),S=m(),z=m(),J=h;(()=>{let e=new Image;e.src=O,e.onload=()=>{z.value=`${e.width} / ${e.height}`}})();const W=e=>{I.value.mediaId=e,I.value.dialogVisible=!0},K=e=>{T.value.mediaId=e,T.value.dialogVisible=!0},Q=e=>{P.value.mediaId=e,P.value.dialogVisible=!0},X=e=>{R.value.mediaId=e.id,R.value.imgUrl=e.media_url,R.value.dialogVisible=!0},Y=e=>{Ve({url:e.media_url,title:Ce(6),type:e.type})},Z=e=>{S.value.fileId=e,S.value.dialogVisible=!0},ee=e=>{j("replaceMoveGroup",e)},te=e=>D(this,null,function*(){let{code:l,msg:$}=yield Fe({id:e});l==200?(L.success("\u5220\u9664\u6210\u529F"),b(),j("replaceGroup",x.value)):L.error($)}),oe=e=>{F.value||(C.value.index=e,C.value.handleOpen())};_e(()=>J.imgs,e=>D(this,null,function*(){yield we(),e.length&&e.forEach((l,$)=>{const G=f.value[$],u=224;let c=0;if(l.type==="audio"){let E=z.value.split("/");c=E[1]/E[0]*u}else l.height&&l.width?c=l.height/l.width*u:c=u;c=parseInt(c/10)*10,G.style.gridRowEnd=`span ${Math.ceil(c)}`})}));const ae=N(()=>e=>e<1024*1024*8?parseInt(e/8/1024)+"kb":parseInt(e/8/1024/1024)+"mb"),ie=N(()=>e=>e.ext=="jpeg"||e.ext=="jpg"||e.ext=="png"),le=N(()=>e=>[...e.tags_zhuci,...e.tags_diqu,...e.tags_miaoshu,...e.tags_jingtou]);return(e,l)=>{const $=n("el-checkbox"),G=n("VideoCamera"),u=n("el-icon"),c=n("Picture"),E=n("Headset"),ne=n("el-tag"),se=n("MoreFilled"),y=n("el-dropdown-item"),re=n("el-dropdown-menu"),de=n("el-dropdown"),ue=n("el-checkbox-group");return a(),s(V,null,[o(ue,{modelValue:w(v),"onUpdate:modelValue":l[0]||(l[0]=t=>he(v)?v.value=t:null),class:"cards",style:q({gridTemplateColumns:`repeat(${h.columns}, 1fr)`}),onChange:w(r)},{default:i(()=>[(a(!0),s(V,null,H(h.imgs,(t,U)=>(a(),s("div",{ref_for:!0,ref_key:"cardRefs",ref:f,class:"card",key:U},[p("div",{class:"img mask",style:q({aspectRatio:t.type==="audio"?z.value:`${t.width} / ${t.height}`}),onClick:d=>oe(U)},[fe(o($,{label:t.id},null,8,["label"]),[[ge,w(F)]]),t.type==="audio"?(a(),s("img",{key:0,src:w(O),alt:""},null,8,Ie)):(a(),s("img",{key:1,src:t.cover_url,alt:""},null,8,Te)),w(F)?_("",!0):(a(),s(V,{key:2},[p("div",Pe,[(a(!0),s(V,null,H(le.value(t),(d,ce)=>(a(),s("div",{class:"tag_item",key:ce},g(d),1))),128))]),p("div",Se,[t.type=="video"?(a(),A(u,{key:0},{default:i(()=>[o(G)]),_:1})):_("",!0),t.type=="image"?(a(),A(u,{key:1},{default:i(()=>[o(c)]),_:1})):_("",!0),t.type=="audio"?(a(),A(u,{key:2},{default:i(()=>[o(E)]),_:1})):_("",!0),t.type=="video"||t.type=="audio"?(a(),s("span",ze,g(w(xe)(t.duration)),1)):_("",!0)]),o(ne,{class:"addBtn",size:"large",effect:"plain",onClick:ke(d=>W(t.id),["stop"])},{default:i(()=>[k("\u6807\u7B7E\u7BA1\u7406")]),_:2},1032,["onClick"]),p("div",Ge,[t.type!=="audio"?(a(),s("p",De,"\u5C3A\u5BF8\uFF1A"+g(t.width)+"*"+g(t.height),1)):_("",!0),p("p",null,"\u5927\u5C0F\uFF1A"+g(ae.value(t.size)),1),p("p",null,"\u4E0A\u4F20\u65F6\u95F4\uFF1A"+g(t.create_time),1)])],64))],12,Be),p("div",Ne,[p("span",je,g(t.name),1),o(de,{placement:"top"},{dropdown:i(()=>[o(re,null,{default:i(()=>[o(y,{icon:"EditPen",onClick:d=>K(t.id)},{default:i(()=>[k("\u7F16\u8F91")]),_:2},1032,["onClick"]),t.ext==="mp4"?(a(),A(y,{key:0,icon:"Histogram",onClick:d=>Q(t.id)},{default:i(()=>[k("\u5206\u5272")]),_:2},1032,["onClick"])):_("",!0),ie.value(t)?(a(),A(y,{key:1,icon:"Crop",onClick:d=>X(t)},{default:i(()=>[k("\u88C1\u5207")]),_:2},1032,["onClick"])):_("",!0),o(y,{icon:"Download",onClick:d=>Y(t)},{default:i(()=>[k("\u4E0B\u8F7D")]),_:2},1032,["onClick"]),o(y,{icon:"Rank",onClick:d=>Z(t.id)},{default:i(()=>[k("\u79FB\u52A8")]),_:2},1032,["onClick"]),o(y,{icon:"Delete",onClick:d=>te(t.id)},{default:i(()=>[k("\u5220\u9664")]),_:2},1032,["onClick"])]),_:2},1024)]),default:i(()=>[o(u,null,{default:i(()=>[o(se)]),_:1})]),_:2},1024)])]))),128))]),_:1},8,["modelValue","style","onChange"]),o(ve,{ref_key:"previewRef",ref:C,files:h.imgs},null,8,["files"]),o(be,{ref_key:"EditTags",ref:I},null,512),o($e,{ref_key:"EditMedia",ref:T},null,512),o(Ae,{ref_key:"SegmentMedia",ref:P},null,512),o(Re,{ref_key:"CutMedia",ref:R},null,512),o(Ee,{ref_key:"MoveMmedia",ref:S,onReplaceMoveGroup:ee},null,512)],64)}}}),dt=ye(Ue,[["__scopeId","data-v-2378ce30"]]);export{dt as default};
