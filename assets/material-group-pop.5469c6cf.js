var K=Object.defineProperty;var M=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var U=(s,a,u)=>a in s?K(s,a,{enumerable:!0,configurable:!0,writable:!0,value:u}):s[a]=u,C=(s,a)=>{for(var u in a||(a={}))Q.call(a,u)&&U(s,u,a[u]);if(M)for(var u of M(a))W.call(a,u)&&U(s,u,a[u]);return s};var h=(s,a,u)=>new Promise((V,F)=>{var w=d=>{try{_(u.next(d))}catch(m){F(m)}},D=d=>{try{_(u.throw(d))}catch(m){F(m)}},_=d=>d.done?V(d.value):Promise.resolve(d.value).then(w,D);_((u=u.apply(s,a)).next())});import{l as A}from"./lodash.a9e36c73.js";import{d as X,a0 as Y,r as g,j as p,o as E,b as k,w as r,k as i,n as N,l as b,c as I,y as R,F as S,E as y}from"./index.5a90395c.js";import{u as ee}from"./material.85a80f57.js";import{f as le,h as ue,i as oe}from"./creative.ea528d59.js";import{Z as ae}from"./config.d0c812d6.js";import"./keyword.011c6f30.js";const ce=X({__name:"material-group-pop",props:{activeName:{type:String,required:!0}},emits:["renewGroup"],setup(s,{expose:a,emit:u}){const V=ee(),{system_tags:F,keywords:w,groupId:D}=Y(V),_=g("\u521B\u5EFA\u7D20\u6750\u7EC4"),d=u,m=g(!1),c=g(!1),f=g(""),o=g({name:"",zhuci:[],miaoshu:[],jingtou:[]}),z=g(),q=g({name:[{required:!0,message:"\u8BF7\u8F93\u5165\u7D20\u6750\u7EC4\u540D\u79F0",trigger:"blur"}]}),T=s,Z=()=>h(this,null,function*(){if(console.log(f.value),f.value){_.value="\u7F16\u8F91\u7D20\u6750\u7EC4";let{code:t,data:e,msg:v}=yield le({id:f.value});if(t==200)for(let n in o.value)o.value[n]=e[n];else y.error(v)}}),L=()=>{f.value="",o.value.name="",o.value.zhuci=[],o.value.miaoshu=[],o.value.jingtou=[]},O=()=>h(this,null,function*(){try{yield z.value.validate(),T.activeName==="first"?f.value?$():P():console.log("\u53E3\u64AD\u64CD\u4F5C")}catch(t){console.log(t)}}),P=()=>h(this,null,function*(){const t=A.exports.cloneDeep(o.value);t.zhuci.length&&(t.zhuci=t.zhuci.map(B=>B[1])),c.value=!0;let{code:e,data:v,msg:n}=yield ue(C({type:0},t));e==200?(y.success("\u521B\u5EFA\u6210\u529F"),m.value=!1,D.value=v.id,d("renewGroup")):y.error(n),c.value=!1}),$=()=>h(this,null,function*(){const t=A.exports.cloneDeep(o.value);t.zhuci.length&&(t.zhuci=t.zhuci.map(n=>n[1])),c.value=!0;let{code:e,msg:v}=yield oe(C({id:f.value},t));e==200?(y.success("\u4FEE\u6539\u6210\u529F"),m.value=!1,d("renewGroup")):y.error(v),c.value=!1});return a({dialogVisible:m,groupId:f}),(t,e)=>{const v=p("el-input"),n=p("el-form-item"),B=p("el-cascader"),G=p("el-option"),j=p("el-select"),H=p("el-form"),x=p("el-button"),J=p("el-dialog");return E(),k(J,{modelValue:m.value,"onUpdate:modelValue":e[5]||(e[5]=l=>m.value=l),draggable:"","destroy-on-close":"",title:_.value,width:"540","close-on-click-modal":!c.value,"close-on-press-escape":!c.value,onOpen:Z,onClosed:L},{footer:r(()=>[i(x,{disabled:c.value,onClick:e[4]||(e[4]=l=>m.value=!1)},{default:r(()=>[N("\u53D6\u6D88")]),_:1},8,["disabled"]),i(x,{loading:c.value,type:"primary",onClick:O},{default:r(()=>[N("\u786E\u5B9A")]),_:1},8,["loading"])]),default:r(()=>[i(H,{ref_key:"ruleFormRef",ref:z,model:o.value,rules:q.value},{default:r(()=>[i(n,{prop:"name"},{default:r(()=>[i(v,{modelValue:o.value.name,"onUpdate:modelValue":e[0]||(e[0]=l=>o.value.name=l),modelModifiers:{trim:!0},"show-word-limit":"",maxlength:"15",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u7D20\u6750\u7EC4\u540D"},null,8,["modelValue"])]),_:1}),i(n,null,{default:r(()=>[i(B,{modelValue:o.value.zhuci,"onUpdate:modelValue":e[1]||(e[1]=l=>o.value.zhuci=l),style:{width:"100%"},options:b(w),props:b(ae),placeholder:"\u8BF7\u9009\u62E9\u5173\u952E\u8BCD\u6807\u7B7E","show-all-levels":!1,clearable:""},null,8,["modelValue","options","props"])]),_:1}),i(n,null,{default:r(()=>[i(j,{modelValue:o.value.miaoshu,"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.miaoshu=l),style:{width:"100%"},multiple:"",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u7D20\u6750\u63CF\u8FF0\u6807\u7B7E"},{default:r(()=>[(E(!0),I(S,null,R(b(F).miaoshu,l=>(E(),k(G,{key:l.name,label:l.name,value:l.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),i(n,null,{default:r(()=>[i(j,{modelValue:o.value.jingtou,"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.jingtou=l),style:{width:"100%"},multiple:"",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u955C\u5934\u6807\u7B7E"},{default:r(()=>[(E(!0),I(S,null,R(b(F).jingtou,l=>(E(),k(G,{key:l.name,label:l.name,value:l.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","close-on-click-modal","close-on-press-escape"])}}});export{ce as default};
