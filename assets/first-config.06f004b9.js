var H=(b,B,C)=>new Promise((p,y)=>{var f=s=>{try{g(C.next(s))}catch(F){y(F)}},_=s=>{try{g(C.throw(s))}catch(F){y(F)}},g=s=>s.done?p(s.value):Promise.resolve(s.value).then(f,_);g((C=C.apply(b,B)).next())});import{d as J,r as k,T as W,j as u,v as X,o as h,b as E,w as l,A as Y,c as D,a as m,F as O,y as U,x as q,t as j,k as t,n as K,_ as P,E as z,a0 as L,l as i,q as G,p as Z,f as ee}from"./index.5a90395c.js";import{u as oe}from"./material.85a80f57.js";import{u as te}from"./mixShear.0f781a9f.js";import{f as ae}from"./index.0e306189.js";import le from"./choose-ratio.cc8d6496.js";import ne from"./background-mode.75fa8d30.js";import ue from"./background-config.61fe2eab.js";import{I as se}from"./ImportMeterial.9b103172.js";import{h as re}from"./make.3dd199c4.js";import"./creative.ea528d59.js";import"./keyword.011c6f30.js";import"./ratio.d5eac44d.js";import"./MediumPreview.37c6af48.js";import"./index.browser.2b0920b0.js";import"./AliCloudUpload.13488d40.js";import"./Pagination.554cb32d.js";import"./audio.531569af.js";const ce={class:"content"},de={class:"tabs"},ie=["onClick"],_e=["src"],me={class:"foot"},pe=J({__name:"SystemBackground",emits:["handleAddBackground"],setup(b,{expose:B,emit:C}){const p=k(!1),y=k([]),f=k(0),_=k([]),g=k(!1),s=k([{name:"\u5168\u90E8",type:0},{name:"\u84DD\u8272",type:1},{name:"\u9ED1\u8272",type:2},{name:"\u767D\u8272",type:3},{name:"\u7EA2\u8272",type:4},{name:"\u5176\u4ED6",type:5}]),F=C,e=()=>{A()},A=()=>H(this,null,function*(){g.value=!0;let{code:a,data:o,msg:r}=yield re({type:"background"});a==200?y.value=o:z.error(r),g.value=!1}),R=a=>{f.value=a.type},w=a=>_.value.some(o=>o.id===a.id),x=a=>{w(a)?_.value=_.value.filter(o=>o.id!==a.id):_.value.push(a)},V=()=>{F("handleAddBackground",_.value),p.value=!1},M=W(()=>y.value.filter(a=>f.value===0?a:a.type===f.value)),$=()=>{_.value=[]};return B({drawer:p}),(a,o)=>{const r=u("el-checkbox"),v=u("el-col"),c=u("el-row"),d=u("el-scrollbar"),S=u("el-button"),I=u("el-drawer"),T=X("loading");return h(),E(I,{modelValue:p.value,"onUpdate:modelValue":o[0]||(o[0]=n=>p.value=n),title:"\u7CFB\u7EDF\u80CC\u666F",size:364,onOpen:e,onClosed:$},{default:l(()=>[Y((h(),D("div",ce,[m("div",de,[(h(!0),D(O,null,U(s.value,n=>(h(),D("div",{class:q(["tabs_item",{select:n.type===f.value}]),key:n.type,onClick:N=>R(n)},j(n.name),11,ie))),128))]),t(d,null,{default:l(()=>[t(c,{class:"backgrounds"},{default:l(()=>[(h(!0),D(O,null,U(M.value,n=>(h(),E(v,{class:"background_item",span:12,key:n.id,onClick:N=>x(n)},{default:l(()=>[m("div",{class:q(["img",{choose:w(n)}])},[m("img",{src:n.cover_url,alt:""},null,8,_e),t(r,{"model-value":!0})],2)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),m("div",me,[t(S,{type:"primary",onClick:V},{default:l(()=>[K("\u5DF2\u9009\u62E9"+j(_.value.length)+" \u6DFB\u52A0\u80CC\u666F",1)]),_:1})])])),[[T,g.value]])]),_:1},8,["modelValue"])}}}),fe=P(pe,[["__scopeId","data-v-2950f248"]]);const Q=b=>(Z("data-v-5ed5e463"),b=b(),ee(),b),ge={class:"first"},ve={class:"top"},ke=Q(()=>m("span",null,"\u7CFB\u7EDF\u80CC\u666F",-1)),he=Q(()=>m("span",null,"\u9009\u62E9\u80CC\u666F",-1)),Ce={class:"foot_btns"},ye=J({__name:"first-config",emits:["handleStepChange"],setup(b,{emit:B}){const C=B,p=k(),y=k(),f=k(),_=oe(),g=te(),{selectMaterals:s,screen:F}=L(_),{form:e}=L(g),A=o=>{e.value.ratio=o.label,e.value.scene_ratio=o.scene,e.value.width=o.width,e.value.height=o.height},R=o=>{e.value.background=o.label},w=()=>{console.log("\u7CFB\u7EDF\u80CC\u666F"),y.value.drawer=!0},x=()=>{F.value.type="image",F.value.uploadedData=["image"],s.value=e.value.data.Background,f.value.drawer=!0},V=o=>{if(!o)return;let r=[...e.value.data.Background,...s.value],v={};e.value.data.Background=r.reduce((c,d)=>(v[d.id]||(v[d.id]=c.push(d)),c),[]),z.success("\u7D20\u6750\u5BFC\u5165\u6210\u529F")},M=o=>{let r=[...e.value.data.Background,...o],v={};e.value.data.Background=r.reduce((c,d)=>(v[d.id]||(v[d.id]=c.push(d)),c),[]),z.success("\u7CFB\u7EDF\u80CC\u666F\u5BFC\u5165\u6210\u529F")},$=o=>{e.value.data.Background=e.value.data.Background.filter(r=>r.id!==o.id)},a=()=>H(this,null,function*(){try{yield p.value.validate(),C("handleStepChange",1)}catch(o){console.log(o)}});return(o,r)=>{const v=u("el-input"),c=u("el-form-item"),d=u("DArrowRight"),S=u("el-icon"),I=u("el-form"),T=u("el-scrollbar"),n=u("el-button");return h(),D("div",ge,[t(T,null,{default:l(()=>[t(I,{class:"outForm",ref_key:"formRef",ref:p,model:i(e),rules:i(ae)},{default:l(()=>[t(c,{label:"\u4EFB\u52A1\u540D\u79F0",prop:"name"},{default:l(()=>[t(v,{modelValue:i(e).name,"onUpdate:modelValue":r[0]||(r[0]=N=>i(e).name=N),maxlength:"20","show-word-limit":"",placeholder:"\u8BF7\u8F93\u5165\u4EFB\u52A1\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(c,{label:"\u7D20\u6750\u6BD4\u4F8B",prop:"ratio"},{default:l(()=>[t(le,{ratio:i(e).ratio,scene:i(e).scene_ratio,onHandleClickRatio:A},null,8,["ratio","scene"])]),_:1}),i(e).ratio==="9:16"&&i(e).scene_ratio==="16:9"?(h(),E(c,{key:0,label:"\u80CC\u666F\u6A21\u5F0F",prop:"background"},{default:l(()=>[t(ne,{background:i(e).background,onHandleClickMode:R},null,8,["background"])]),_:1})):G("",!0),i(e).background==="image"?(h(),E(c,{key:1,label:"\u80CC\u666F\u914D\u7F6E",prop:"data.Background",class:"config"},{default:l(()=>[m("div",ve,[m("span",null,"\u5DF2\u9009\uFF1A"+j(i(e).data.Background.length),1),m("div",{class:"select",onClick:w},[ke,t(S,null,{default:l(()=>[t(d)]),_:1})]),m("div",{class:"select",onClick:x},[he,t(S,null,{default:l(()=>[t(d)]),_:1})])]),t(ue,{backgrounds:i(e).data.Background,onHandleDelete:$},null,8,["backgrounds"])]),_:1})):G("",!0)]),_:1},8,["model","rules"])]),_:1}),m("div",Ce,[t(n,{type:"primary",onClick:a},{default:l(()=>[K("\u4E0B\u4E00\u6B65")]),_:1})]),t(fe,{ref_key:"systemRef",ref:y,onHandleAddBackground:M},null,512),t(se,{ref_key:"meterialRef",ref:f,onCloseDrawer:V},null,512)])}}}),ze=P(ye,[["__scopeId","data-v-5ed5e463"]]);export{ze as default};
