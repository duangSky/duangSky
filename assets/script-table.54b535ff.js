import{d as j,a0 as H,r as V,T as L,W,j as g,o as $,c as B,k as o,w as d,a as _,t as O,F as M,y as P,_ as R,E as w}from"./index.5a90395c.js";import{u as q}from"./material.85a80f57.js";import{I as G}from"./ImportMeterial.9b103172.js";import{A as y}from"./AIToolPop.b04822dd.js";import"./creative.ea528d59.js";import"./keyword.011c6f30.js";import"./index.browser.2b0920b0.js";import"./AliCloudUpload.13488d40.js";import"./Pagination.554cb32d.js";import"./audio.531569af.js";import"./useCopyToClipboard.fba770f6.js";import"./aitools.ae73576d.js";const E=c=>{let p=c.split(`
`),u=[];return p.forEach((s,h)=>{let i=(h+1).toString(),f=s.slice(0,i.length),F=s.slice(i.length,i.length+1),r=s;f==="."?r=i+r:f!==i&&F!=="."?r=`${i}.${r}`:f!==i&&F==="."?r=`${i}${r.slice(i.length)}`:f===i&&F!=="."&&(console.log("??"),r=`${i}.${r.slice(i.length)}`),u.push(r)}),u.join(`
`)},J=c=>c.split(`
`).map((s,h)=>{let i=(h+1).toString();return s.slice(i.length+1)}).filter(s=>s!=="").map((s,h)=>s=`${h+1}.${s}`).join(`
`),K=(c,p)=>{let u;return function(){u&&clearTimeout(u),u=setTimeout(()=>{c()},p)}},Q=c=>{let p={};for(let u in c)u.indexOf("tags")===-1&&(p[u]=c[u]);return p};const X={class:"source"},Y=["src"],Z={class:"operate"},ee=["onClick"],te=["onClick"],le=["onClick"],ne=["onClick"],ae=j({__name:"script-table",props:{edits:{type:Array,defalut:[]}},emits:["handleDeleteScene"],setup(c,{emit:p}){const u=q(),{selectMaterals:s,screen:h}=H(u),i=p,f=V(0),F=V(),r=V(0),C=c,S=()=>{f.value=window.innerHeight-288},x=K(S,600);window.addEventListener("resize",x),S();const A=(t,a,l)=>{if(t.split(`
`).length>10){a[l]=E(t.split(`
`).filter((b,v)=>b&&v<10).join(`
`)),w.warning("\u6700\u591A10\u7EC4");return}a[l]=E(t)},k=(t,a)=>{t[a]!==""&&(t[a]=J(t[a]))},D=(t,a)=>{let l=C.edits.splice(t,1)[0];C.edits.splice(t+a,0,l)},T=t=>{let{$index:a,row:l}=t;r.value=a,s.value=l.Material,h.value.uploadedData=["video","image"],F.value.drawer=!0},I=t=>{t&&(C.edits[r.value].Material=s.value.map(a=>Q(a)),w.success("\u7D20\u6750\u5BFC\u5165\u6210\u529F"))},U=(t,a)=>{t.Material=t.Material.filter(l=>l.id!==a.id)},z=L(()=>{let t={},a=[];return C.edits.forEach(l=>{a.push(...l.Material)}),a=a.reduce((l,m)=>(t[m.id]||(t[m.id]=l.push(m)),l),[]),a});return W(()=>{window.removeEventListener("resize",x)}),(t,a)=>{const l=g("el-table-column"),m=g("el-input"),b=g("CircleCloseFilled"),v=g("el-icon"),N=g("el-table");return $(),B(M,null,[o(N,{border:"",data:c.edits,"max-height":f.value},{default:d(()=>[o(l,{label:"\u573A\u666F\u5E8F\u53F7",width:"100"},{default:d(e=>[_("span",null,O(e.$index+1),1)]),_:1}),o(l,{label:"\u573A\u666F\u540D\u79F0",width:"150"},{default:d(({row:e})=>[o(m,{class:"sceneName",modelValue:e.Name,"onUpdate:modelValue":n=>e.Name=n,maxlength:"8",placeholder:"\u8BF7\u8F93\u5165\u573A\u666F\u540D\u79F0"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),o(l,{label:"\u6807\u9898",width:"220"},{default:d(({row:e})=>[o(y,{iptValue:e.Title,placement:"right-start"},{iptBox:d(()=>[o(m,{modelValue:e.Title,"onUpdate:modelValue":n=>e.Title=n,type:"textarea",autosize:"",resize:"none",placeholder:"\u8BF7\u8F93\u5165\u6807\u9898",onInput:n=>A(n,e,"Title"),onBlur:n=>k(e,"Title")},null,8,["modelValue","onUpdate:modelValue","onInput","onBlur"])]),_:2},1032,["iptValue"])]),_:1}),o(l,{label:"\u6587\u6848"},{default:d(({row:e})=>[o(y,{iptValue:e.Subtitle,placement:"right-start"},{iptBox:d(()=>[o(m,{modelValue:e.Subtitle,"onUpdate:modelValue":n=>e.Subtitle=n,type:"textarea",autosize:"",resize:"none",placeholder:"\u8BF7\u8F93\u5165\u6587\u6848",onInput:n=>A(n,e,"Subtitle"),onBlur:n=>k(e,"Subtitle")},null,8,["modelValue","onUpdate:modelValue","onInput","onBlur"])]),_:2},1032,["iptValue"])]),_:1}),o(l,{label:"\u573A\u666F\u63CF\u8FF0",prop:"name",width:"260"},{default:d(({row:e})=>[o(m,{class:"sceneIntro",modelValue:e.Note,"onUpdate:modelValue":n=>e.Note=n,type:"textarea",autosize:"",resize:"none",placeholder:"\u8BF7\u8F93\u5165\u573A\u666F\u63CF\u8FF0"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),o(l,{label:"\u7D20\u6750",width:"320"},{default:d(({row:e})=>[_("div",X,[($(!0),B(M,null,P(e.Material,n=>($(),B("div",{class:"img",key:n.id},[_("img",{src:n.cover_url,alt:""},null,8,Y),o(v,{class:"close",onClick:oe=>U(e,n)},{default:d(()=>[o(b)]),_:2},1032,["onClick"])]))),128))])]),_:1}),o(l,{label:"\u64CD\u4F5C",width:"260"},{default:d(e=>[_("div",Z,[_("span",{onClick:n=>D(e.$index,-1)},"\u4E0A\u79FB\u52A8",8,ee),_("span",{onClick:n=>D(e.$index,1)},"\u4E0B\u79FB\u52A8",8,te),_("span",{onClick:n=>T(e)},"\u6DFB\u52A0\u7D20\u6750",8,le),_("span",{onClick:n=>i("handleDeleteScene",e.$index)},"\u5220\u9664",8,ne)])]),_:1})]),_:1},8,["data","max-height"]),o(G,{ref_key:"importMeterial",ref:F,allScript:z.value,onCloseDrawer:I},null,8,["allScript"])],64)}}}),ge=R(ae,[["__scopeId","data-v-044a43da"]]);export{ge as default};
