var O=Object.defineProperty;var k=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var v=(u,n,t)=>n in u?O(u,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):u[n]=t,V=(u,n)=>{for(var t in n||(n={}))T.call(n,t)&&v(u,t,n[t]);if(k)for(var t of k(n))$.call(n,t)&&v(u,t,n[t]);return u};var w=(u,n,t)=>new Promise((p,s)=>{var F=i=>{try{y(t.next(i))}catch(f){s(f)}},h=i=>{try{y(t.throw(i))}catch(f){s(f)}},y=i=>i.done?p(i.value):Promise.resolve(i.value).then(F,h);y((t=t.apply(u,n)).next())});import{l as j,p as q,q as z}from"./account.f146a620.js";import{d as J,u as L,r as S,g as M,j as D,o as g,c as x,k as d,w as B,a as e,F as G,y as H,t as R,n as U,_ as P,E as m,B as Q,p as W,f as X}from"./index.5a90395c.js";const E=u=>(W("data-v-5e4c01de"),u=u(),X(),u),Y={class:""},Z=E(()=>e("div",{class:"tip"},[e("span",null,"\u573A\u666F\u4ECB\u7ECD\uFF1A\u5F53\u7528\u6237\u5728\u8BC4\u8BBA\u65F6\u89E6\u53D1")],-1)),ee={class:"comment_card"},te={class:"comment_item_top"},ue={class:"comment_title"},oe=["onClick"],ne=E(()=>e("i",{class:"el-icon-delete"},null,-1)),se=E(()=>e("span",null,"\u5220\u9664",-1)),le=[ne,se],ae={class:"comment_item_content"},ce={class:"msg_tip"},ie=E(()=>e("div",{class:"left"},[e("i",{class:"el-icon-warning-outline"}),e("span",null,"\u6D88\u606F\u5185\u5BB9\u4E0D\u80FD\u5305\u542B\u7535\u8BDD/\u793E\u4EA4\u5E73\u53F0\u8D26\u53F7\u7B49\u8054\u7CFB\u65B9\u5F0F\u5185\u5BB9")],-1)),re={class:"right"},_e=E(()=>e("span",null,"\u6DFB\u52A0\u8BC4\u8BBA\u56DE\u590D",-1)),de=[_e],me={class:"footer"},pe=J({__name:"CommentReply",props:{account_id:{type:String,default:""},open_id:{type:String,required:!0}},setup(u,{expose:n}){const t=L(),p=S(!1),s=S([]),F=u;let h=M({filter:{event_type:"comment"},op:{event_type:"="}});const y=()=>w(this,null,function*(){let{code:r,data:c,msg:_}=yield j(V({page:1,limit:999,accountid:F.account_id},h));r==200?c.count?s.value=c.list.map(l=>(l.keyword=JSON.parse(l.keyword).join("\u3001"),l.comment_reply_content=l.comment_reply_content,l)):(s.value=[],f()):m.error(_)});function i(r,c){r.id?Q.confirm("\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664, \u662F\u5426\u7EE7\u7EED?","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>w(this,null,function*(){let{code:_,msg:l}=yield q({list:[r.id]});_==200?(m.success("\u5220\u9664\u6210\u529F"),y()):m.error(l)})).catch(()=>{m.info("\u5DF2\u53D6\u6D88\u5220\u9664")}):s.value.splice(c,1)}const f=()=>{s.value.push({accountid:F.account_id,title:`\u8BC4\u8BBA\u56DE\u590D${s.value.length+1}`,keyword:"",comment_reply_content:[{reply_policy:0,text:""}],event_type:"comment",match_type:0,type:0,reply_type:"mix",status:0,open_id:F.open_id,username:t.info.username})},b=()=>{s.value=[]};function I(){return w(this,null,function*(){let r=!0;if(s.value.filter(o=>{o.keyword?o.comment_reply_content[0].text||(m.warning("\u8BF7\u8F93\u5165\u6D88\u606F\u5185\u5BB9\uFF01"),r=!1):(m.warning("\u8BF7\u8F93\u5165\u5173\u952E\u8BCD\uFF01"),r=!1)}),!r)return;let c=s.value.map(o=>(Array.isArray(o.keyword)||(o.keyword=o.keyword.split("\u3001")),o.im_reply_content&&!Array.isArray(o.im_reply_content)?o.im_reply_content=JSON.parse(o.im_reply_content):o.im_reply_content=o.comment_reply_content,o)),{code:_,msg:l}=yield z({list:c});_==200?(m.success("\u4FDD\u5B58\u6210\u529F"),p.value=!1):m.error(l)})}return n({drawer:p}),(r,c)=>{const _=D("el-input"),l=D("el-form-item"),o=D("el-form"),A=D("el-button"),N=D("el-drawer");return g(),x("div",Y,[d(N,{size:724,modelValue:p.value,"onUpdate:modelValue":c[1]||(c[1]=a=>p.value=a),title:"\u8BC4\u8BBA\u56DE\u590D\u8BBE\u7F6E",onOpen:y,onClose:b},{default:B(()=>[Z,e("div",ee,[(g(!0),x(G,null,H(s.value,(a,K)=>(g(),x("div",{class:"comment_item",key:a.id},[e("div",te,[e("div",ue,R(a.title),1),e("div",{class:"del_comment",onClick:C=>i(a,K)},le,8,oe)]),e("div",ae,[d(o,{model:a,size:"small","label-width":"68px"},{default:B(()=>[d(l,{label:"\u5173\u952E\u8BCD"},{default:B(()=>[d(_,{modelValue:a.keyword,"onUpdate:modelValue":C=>a.keyword=C,placeholder:"\u652F\u6301\u8F93\u5165\u591A\u4E2A\u5173\u952E\u8BCD\u4EE5\u3001\u53F7\u9694\u5F00\uFF0C\u8F93\u5165*\u53F7\u65E0\u89C4\u5219\u89E6\u53D1\u3002"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),d(l,{label:"\u6D88\u606F\u5185\u5BB9"},{default:B(()=>[d(_,{type:"textarea",rows:6,modelValue:a.comment_reply_content[0].text,"onUpdate:modelValue":C=>a.comment_reply_content[0].text=C,maxlength:300},null,8,["modelValue","onUpdate:modelValue"]),e("div",ce,[ie,e("div",re,[e("span",null,R(a.comment_reply_content[0].text.length)+"/300",1)])])]),_:2},1024)]),_:2},1032,["model"])])]))),128)),e("div",{class:"add_comment",onClick:f},de)]),e("div",me,[d(A,{onClick:c[0]||(c[0]=a=>p.value=!1)},{default:B(()=>[U("\u5173\u95ED")]),_:1}),d(A,{type:"primary",onClick:I},{default:B(()=>[U("\u4FDD\u5B58")]),_:1})])]),_:1},8,["modelValue"])])}}}),Fe=P(pe,[["__scopeId","data-v-5e4c01de"]]);export{Fe as default};
